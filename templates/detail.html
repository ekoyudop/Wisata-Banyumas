<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" href="/static/Logo.png" type="image/x-icon">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous">
        </script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
        integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous">
        </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"
        integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous">
        </script>

    <!-- font family -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;600;800&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- Sweet alert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <title>Wisata Banyumas</title>
    <style>
        body {
            background-color: #f3f4f5;
        }

        /* Navbar styles strart */
        .navbar {
            background-color: #17594A;
        }

        .menu button {
            color: white;
            transition: color 0.3s;
            height: 50px;
            width: 150px;
            margin-left: 5px;
            margin-right: 5px;
            font-weight: bold;
        }

        .menu button:hover {
            color: black;
            background-color: white;
        }

        /* Navbar styles strart */

        /* footer start */
        .home-footer {
            width: auto;
            height: auto;
            background-color: white;
            margin: auto auto auto auto;
            padding: 20px;
            position: relative;
        }

        .row {
            max-width: 1500px;
            margin: 0 auto;
            display: flex;
        }

        .row button:hover {
            transform: scale(1.03);
            border-radius: 1rem;
            transition: .3s;
        }

        .home-footer1 {
            width: 100%;
            height: 30px;
            background-color: black;
            color: white;
            text-align: center;
            position: relative;
        }

        /* footer end */

        .nmwisata {
            width: auto;
            height: auto;
            padding: 10px;
            background-color: white;
            color: black;
        }

        .detailwisata {
            width: 95%;
            max-width: 1980px;
            height: auto;
            margin: 20px auto auto auto;
            color: black;
        }

        /* .p-2 {
            display: none;
        } */

        .detailwisata h4 {
            font-family: 'Poppins', sans-serif;
        }

        .detailwisata h2 {
            font-family: 'Poppins', sans-serif;
        }

        .nmwisata h1 {
            font-family: 'Poppins', sans-serif;
        }

        .imgwisata {
            width: 100%;
            height: 550px;
        }

        .imgwisata img {
            object-fit: cover;
            object-position: center;
            width: 100%;
            height: 100%;
        }

        .imgwisata :hover {
            transform: scale(1.03);
            border-radius: 1rem;
            transition: .3s;
        }

        .iframegmaps {
            width: 100%;
            height: 550px;
        }

        .iframegmaps iframe {
            object-fit: cover;
            width: 100%;
            height: 100%;
        }

        .card {
            height: 100%;
        }

        .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .brand {
            order: 1;
            /* Untuk menempatkan brand di sebelah kiri */
        }

        .menu-container {
            order: 2;
            /* Untuk menempatkan menu di sebelah kanan */
        }

        @media (max-width: 480px) {
            .card {
                width: 100%;
                height: 100%;
            }

            .container {
                flex-direction: column;
            }

            .menu-container {
                margin-bottom: 10px;
            }

            .brand img {
                width: 0px;
            }
        }
    </style>
    <script>
        $(document).ready(function () {
            if ("{{like_cek}}" == "True") {
                $('#like-true').toggleClass("d-none")
                $('#like-false').toggleClass("d-none")
            }
        })

        function logout() {
            $.removeCookie('mytoken', { path: '/' })
            Swal.fire({
                title: "Anda telah logout",
                text: "Kami menanti kedatanganmu kembali ðŸ˜Š",
                icon: "success",
                showConfirmButton: false,
                timer: 3000
            });

            // Menunda pengalihan halaman selama 2 detik
            setTimeout(function () {
                window.location.href = '/';
            }, 2000);
        }

        function komentar() {
            let comment = $("#area_komentar").val();
            let id_wisata = "{{ info_wisata._id }}";

            $.ajax({
                type: "POST",
                url: '/komentar', // Update the URL to match your server endpoint
                data: {
                    komentar_give: comment,
                    id_wisata_give: id_wisata,
                },
                success: function (response) {
                    Swal.fire({
                        title: "Berhasil",
                        text: `${response['msg']}`,
                        icon: "success",
                        showConfirmButton: false,
                        timer: 3000
                    });

                    // Menunda pengalihan halaman selama 1 detik
                    setTimeout(function () {
                        window.location.reload()
                    }, 1000);
                },
                error: function (xhr, status, error) {
                    // Handle errors, show an alert, or update UI to indicate failure
                    console.error(xhr.responseText);
                    // Show an alert using SweetAlert
                    Swal.fire({
                        icon: 'error',
                        title: 'Error!',
                        text: 'Failed to post comment. Please try again.',
                    });
                }
            });
        }

        function update_like() {
            let action
            if ($('#like-false').hasClass('d-none')) {
                action = "unlike"
            } else {
                action = "like"
            }

            let id_wisata = "{{ info_wisata._id }}"

            console.log(id_wisata)
            console.log(action)
            $.ajax({
                type: 'POST',
                url: "/update_like",
                data: {
                    id_wisata_give: id_wisata,
                    action_give: action
                },
                success: function (response) {
                    if (response['result'] === 'success') {
                        $('#like-true').toggleClass("d-none")
                        $('#like-false').toggleClass("d-none")
                    }
                }
            })
        }

        function showFullImage(imagePath, description) {
            $('#fullImage').attr('src', imagePath);
            $('#imageDescription').text(description);
            $('#imageModal').modal('show');
        }

        function showEditComment(commentId) {
            $('#komentar_' + commentId).hide();
            $('#edit_komentar_' + commentId).show();
        }

        function hideEditComment(commentId) {
            $('#komentar_' + commentId).show();
            $('#edit_komentar_' + commentId).hide();
        }

        function updateComment(commentId) {
            let updatedComment = $("#form_edit_" + commentId).val();

            console.log(commentId)

            $.ajax({
                type: "PUT",
                url: "/komentar/" + commentId,
                data: {
                    updated_komentar: updatedComment,
                },
                success: function (response) {
                    if (response['result'] === 'success') {
                        Swal.fire({
                            title: "Berhasil!",
                            text: response['msg'],
                            icon: "success",
                            showConfirmButton: false,
                            timer: 3000
                        });
                        // Menunda pengalihan halaman selama 2 detik
                        setTimeout(function () {
                            window.location.reload();
                        }, 2000);
                    }
                },
            });
        }

        function delete_komentar(commentId) {
            $.ajax({
                type: "DELETE",
                url: "/komentar/" + commentId,
                success: function (response) {
                    if (response['result'] === 'success') {
                        Swal.fire({
                            title: "Deleted!",
                            text: response['msg'],
                            icon: "success",
                            showConfirmButton: false,
                            timer: 3000
                        });
                        // Menunda pengalihan halaman selama 2 detik
                        setTimeout(function () {
                            window.location.reload();
                        }, 2000);
                    }
                },
            });
        }
    </script>
</head>

<body>
    <nav class="navbar sticky-top">
        <div class="container">
            <div class="brand">
                <img src="/static/Logo.png" alt="logo" width="100px">
            </div>
            <div class="menu-container text-center">
                <div class="menu px-1">
                    <button onclick="window.location.href='/home'" type="button"
                        class="btn btn-outline-light">Home</button>
                    <button onclick="logout()" type="button" class="btn btn-outline-light">Logout</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Judul Start -->
    <div class="nmwisata">
        <div class="mt-2 text-center">
            <h1>{{ info_wisata.nama_wisata }}</h1>
        </div>
    </div>
    <!-- Judul End -->

    <div class="detailwisata">
        <div class="row">
            <div class="col-12 col-md-6 order-md-2">
                <p> Apakah anda menyukai wisata ini ?
                    <a onclick="update_like()"><i style="font-size:24px; cursor: pointer;" id="like-false"
                            class="fa">&#xf087;</i><i id="like-true" class="fa fa-thumbs-up d-none"
                            style="font-size:24px;color:goldenrod; cursor: pointer;"></i></a>
                </p>

                <div class="mb-5">
                    <h4 class="mb-4">Gambar wisata</h4>
                    <div class="imgwisata text-center" style="height: auto;">
                        <img class="img-fluid" src="/static/wisata_pics/{{info_wisata.gambar_wisata}}" alt="">
                        <button class="btn btn-success mt-1" type="button" data-bs-toggle="modal"
                            data-bs-target="#imageModal"
                            onclick="showFullImage('/static/wisata_pics/{{info_wisata.gambar_wisata}}', '{{info_wisata.deskripsi | striptags | truncate(300) }}')">Lihat
                            Gambar</button>
                    </div>
                </div>
                <div class="mb-5">
                    <h4 class="mb-4">Lokasi Google Maps</h4>
                    <div class="iframegmaps">
                        {{ info_wisata.link_iframe|safe }}
                        <a href=" {{ info_wisata.link_gmaps }}" target="_blank" style="text-decoration: none;">
                            <div class="d-grid">
                                <button class="btn btn-success" type="button">Lihat di Google Maps</button>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-6 order-md-1">
                <button type="button" class="btn btn-success" data-bs-container="body" data-bs-toggle="popover"
                    data-bs-placement="top" data-bs-content="Top popover">
                    Lokasi : {{ info_wisata.lokasi_wisata }}
                </button>
                <!-- Blog Detail Start -->
                <div class="mb-5 mt-4">
                    <h4 class="mb-4">Deskripsi</h4>
                    <p>{{ info_wisata.deskripsi | safe }}</p>
                </div>
                <!-- Blog Detail End -->

                <!-- Comment Form Start -->
                <div class="bg-white p-2">
                    <div class="text-center mt-3">
                        <h6 class="text-success text-uppercase" style="letter-spacing: 5px;">Review</h6>
                        <h2>Comments Here ðŸ‘ŒðŸ‘Œ</h2>
                    </div>
                    <form id="commentForm">
                        <div class="row g-3">
                            <div class="col-12">
                                <div class="form-floating">
                                    <textarea class="form-control" placeholder="Leave a comment here" id="area_komentar"
                                        style="height: 100px"></textarea>
                                    <label for="area_komentar">Comments</label>
                                </div>
                            </div>
                            <div class="col-12">
                                <button type="button" class="btn btn-success w-100 py-3" onclick="komentar()">Leave Your
                                    Comment</button>
                            </div>
                        </div>
                    </form>
                </div>
                <!-- Comment Form End -->

                <!-- Comment List Start -->
                <div class="mb-5 mt-5">
                    <h4 class="mb-4">{{ jumlah_komentar }} Comments</h4>

                    {% if jumlah_komentar > 0 %}
                    {% for comment in komentar_wisata | reverse %}
                    <div class="card mb-4" style="border-radius: 10px;" id="komentar_{{ comment._id}}">
                        <div class="card-body">
                            <div class="d-flex mt-1">
                                <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor"
                                    class="bi bi-person-circle" viewBox="0 0 16 16">
                                    <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0" />
                                    <path fill-rule="evenodd"
                                        d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1" />
                                </svg>
                                <div class="ps-3">
                                    <h6><strong>{{ comment.username }}</strong>
                                        <small><i>{{ comment.tanggal}}</i></small>
                                    </h6>
                                    <p>{{ comment.komentar }}</p>
                                </div>
                                {% if comment.useremail == user_info.useremail %}
                                <div class="ms-auto ps-3">
                                    <button type="button" class="btn" onclick="showEditComment('{{ comment._id}}')">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                            fill="currentColor" class="bi bi-pencil-fill" viewBox="0 0 16 16">
                                            <path
                                                d="M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.5.5 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11z" />
                                        </svg>
                                    </button>
                                    <button type="button" class="btn" onclick="delete_komentar('{{ comment._id}}')"><svg xmlns="http://www.w3.org/2000/svg" width="16"
                                            height="16" fill="currentColor" class="bi bi-trash-fill"
                                            viewBox="0 0 16 16">
                                            <path
                                                d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5M8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5m3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0" />
                                        </svg>
                                    </button>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    {% if comment.useremail == user_info.useremail %}
                    <div class="card mb-4" id="edit_komentar_{{ comment._id }}"
                        style="border-radius: 10px; display: none;">
                        <div class="card-body">
                            <div class="d-flex mt-1">
                                <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor"
                                    class="bi bi-person-circle" viewBox="0 0 16 16">
                                    <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0" />
                                    <path fill-rule="evenodd"
                                        d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1" />
                                </svg>
                                <div class="ps-3">
                                    <h6><strong>{{ comment.username }}</strong>
                                        <small><i>{{ comment.tanggal}}</i></small>
                                    </h6>
                                    <div class="div mb-2">
                                        <input type="text" class="form-control" id="form_edit_{{ comment._id }}"
                                            placeholder="Comment" value="{{comment.komentar}}">
                                    </div>
                                    <button type="button" class="btn btn-primary"
                                        onclick="updateComment('{{ comment._id }}')">Perbarui</button>
                                    <button type="button" class="btn btn-secondary"
                                        onclick="hideEditComment('{{ comment._id}}')">Cancel</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                    {% endfor %}
                    {% else %}
                    <p>No comments available.</p>
                    {% endif %}
                </div>
                <!-- Comment List End -->
            </div>
        </div>
    </div>

    <!-- Image Modal -->
    <div class="modal fade" id="imageModal" tabindex="-1" role="dialog" aria-labelledby="imageModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="imageModalLabel">Full Image</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center">
                        <img id="fullImage" class="img-fluid" src="" alt="Full Image">
                    </div>
                    <!-- Add Description Section -->
                    <div class="mt-3 text-left">
                        <h6>Deskripsi Singkat:</h6>
                        <p id="imageDescription"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="home-footer mt-5">
        <div class="d-flex flex-wrap justify-content-evenly align-items-center">
            <img alt="logoittp" src="/static/ITTP_Logo.png" class="p-2" height="75px" />
            <div class="p-2">
                <b>Developer</b> <br>
                <li>Akmal Fikri Muhammad Pasaribu</li>
                <li>Eko Yudo Prayitno</li>
                <li>Feriardus Orlan Banggur</li>
            </div>
        </div>
    </footer>
    <footer class="home-footer1">
        <span class="home-text11">
            Â©2024 Develop by ITTP Student
        </span>
    </footer>

</body>

</html>